---
title: "Effects of Climate Change on Estuarine Fish Assemblages"
abstract: "This is a test abstract"
authors:
  - name: "Garrett Miller"
    orcid: "0009-0007-6253-2554"
    affiliation:
      - name: The University of South Florida
        department: College of Marine Science
format: html
reference-doc: results_formatting.docx
editor: visual
bibliography: references.bib
---

```{r loadLibraries}
#| include: FALSE
library(tidyverse)
library(patchwork)
library(lubridate)
library(vegan)
#library(BiodiversityR)
#library(MASS)
#library(colortools)
library(ggrepel)
library(RColorBrewer)
library(egg)
library(ggpmisc) #for labeling
library(broom) #for labeling
library(DHARMa)
library(gridExtra)
library(gridGraphics)
library(grid)
library(pander)
library(pixiedust) #for model output formats

Sys.setenv(FISHBASE_API="sealifebase")
#knitr::opts_chunk$set(echo = TRUE)
```

# Introduction {.unnumbered}

Global climate change is having strong effects on biodiversity and associated ecosystem structure and functions [@Doney2012; @Poloczanska2016; @Murphy2020]. Shifts in species distributions [@McCarty2001], changes in phenology [@Stenseth2002], and changes in biodiversity [@Dornelas2019] have been observed globally. However, the direction and magnitude of change varies. For example, species richness is declining around the equator and increasing at midlatitudes [@Chaudhary2021]. Some taxa are migrating poleward while others remain unchanged in distribution [@Parmesan1999; @Perry2005; @Chivers2017]. Given that changes in biodiversity can affect ecosystem stability [@Hautier2015], there has been increased concern about how climate change will alter ecosystems, including rainforests [@Levine2016], coral reefs [@Toth2019], and estuaries [@Erickson2021]. However, our understanding of changes in ecosystem stability has been limited by a paucity of long-term time series data [but see @Dornelas2018]. Further, many ecosystems at lower latitudes have received comparatively less attention than those at higher latitudes. Understanding stability in these lower latitude ecosystems can shed light on their responses to climate change and broaden our understanding about generalities.

Temperature is known to affect population-level demographics in several ways, including the sex ratio of offspring [@Ospina-Alvarez2008], growth rates of young [@Raventos2021], and individual survivorship [@Stevens2016]. However, the effects of shifting temperatures are more nuanced at the community level. Studies have highlighted such influences as changes in seasonal weather extremes [@Easterling2000; @Miner2021], shifts in season duration [@Cooper2014], and variation in disturbance frequency, intensity, and duration [@Dale2001], among others. Such factors can drive community-level change in different magnitudes and directions. For example, as distributions of taxa shift in response to warming temperature, the invasion of predators and new pathogens can lead to the extirpation of native species [@Sax2007]. Although average temperatures are increasing globally, the magnitude of these changes may not be consistent among seasons, with warming expected to occur more quickly in the winter than the summer for many ecosystems [@Clark2020]. This seasonal imbalance in temperature change has already contributed to the global poleward expansion of mangroves and is linked to a reduction in frequency and intensity of cold weather events [@Saintilan2014]. Given the importance of season on biota globally, such asymmetric change in temperature may have complex effects. For example, the intensity of a preceding winter is associated with differences in the springtime estuarine fish assemblages that follow [@Curran2019]. In addition, the simultaneous increase in temperature variability due to climate change has been demonstrated to directly influence species richness, with concurrent effects on community stability [@Zhang2018]. Within marine systems, there is evidence that regions at lower latitude have become less stable compared to their higher latitude counterparts due to their responses to temperature [@Miner2021].

The eastern Gulf of Mexico (eGOM) is a productive subtropical region that supports diverse communities including mangrove- and marshgrass-dominated estuaries, seagrass systems, and hardbottom reefs. The region is bisected by the Northern Gulf of Mexico ecoregion to the north and Floridian to the south, which are characterized by compositionally different marine assemblages [@Spalding2007]. Seagrass systems across this region act as important juvenile habitats for many fishes and have high regional variability in the populations and communities they support [@Schrandt2018; @Faletti2019; @Peake2022]. Globally, temperate ecosystems are undergoing tropicalization, with previously rare or absent tropically-associated taxa increasing in abundance through time [@Nakamura2013; @Osland2021]. The effects of these invading taxa are profound and can lead to regime shifts [@Verges2014; @Wernberg2016]. Yet, there is evidence that some subtropical ecosystems are resilient to tropicalization due to additional factors, such as dispersal limitations of potential invaders [@Mizerek2021]. In the eGOM, the expansion of three co-occurring mangrove species in Florida estuaries has been linked to reduced frequency of extreme cold events [@Cavanaugh2014] and is already creating novel mangrove-marsh assemblages [@Cook-Patton2015], with shifts in faunal communities predicted to follow [@Scheffel2018]. Indeed, warmer winter temperatures have been associated with the poleward expansion of a mangrove-associated fish species in this region [@Purtlebaugh2020] and affected community stability in other estuarine systems in North America [@Miner2021].

Increased abundance of tropically-associated taxa had already been observed in northern Gulf of Mexico (nGOM) seagrass systems as early as 2006, potentially indicating tropicalization by taxa from the Floridian ecoregion [@Fodrie2010]. However, Fodrie et al. [-@Fodrie2010] was restricted to the northernmost edge of the eGOM as well as only the summer and fall seasons. Further, assemblages commonly differ between summer and winter in subtropical and temperate estuaries [@Hagan2003; @Strydom2015; @Schrandt2020]. Thus, it is unclear how estuarine systems across the broader eGOM may be responding to climate change, especially in the context of imbalanced seasonal temperature change. Long-term data collected consistently within and across multiple eGOM estuaries that span temperate and subtropical latitudes can improve our ability to evaluate the stability of these assemblages and establish a timeline of tropicalization in this region. Long-term time series data are available in the eGOM, where estuarine seine hauls have been conducted monthly since 1997 and followed consistent study designs and methods. Using these data, I will investigate whether fish assemblages in estuaries within the eGOM have changed over a 20-year period in response to climate change. Specifically, I will address the following questions: 1) has the richness and abundance of eGOM estuarine fish assemblages changed over a 20-year period? 2) Has the composition and stability of eGOM estuarine fish assemblages changed over time and, if so, are these changes related to water temperature? 3) Has the within-season variability of eGOM estuarine fish assemblages changed over time?

# Methods {.unnumbered}

### Data collection

This study used data collected by the Florida Fish and Wildlife Research Institute's (FWRI) Fisheries Independent Monitoring (FIM) program. The program follows a monthly stratified random sampling design in estuaries across Florida, including four in the eastern Gulf of Mexico (from north to south: Apalachicola Bay, Cedar Key, Tampa Bay, and Charlotte Harbor; @fig-FIMsystems). Apalachicola Bay is a shallow, semi-enclosed estuary located on the northern coast of the GOM in the panhandle of Florida, USA and is within the Northern Gulf of Mexico ecoregion [@Spalding2007]. Cedar Key is located within the Suwannee River open estuary system and is also in the Northern Gulf of Mexico ecoregion. Tampa Bay is Florida's largest open water estuary and lies within the Floridian ecoregion [@Spalding2007]. Charlotte Harbor, a drowned river estuary system, is within the Floridian ecoregion [@FWRIFloridaFishandWildlifeResearchInstitute2017]. All systems are dominated by seagrass vegetation in shallow waters, except for Apalachicola Bay, where seagrass is less than 7% of bottom coverage [@FWRIFloridaFishandWildlifeResearchInstitute2017]. However, sampling gear was partly determined by habitat, where all seagrass at particular depths were sampled with the same gear type across estuaries [see also below, @FWRIFloridaFishandWildlifeResearchInstitute2017]. Finally, marsh grasses and oyster beds are dominant along shorelines in Apalachicola Bay and Cedar Key, while mangroves dominate in Charlotte Harbor, and Tampa Bay is characterized by a mix of marsh grasses, oyster beds, and mangroves [@FWRIFloridaFishandWildlifeResearchInstitute2017].

![Locations of all estuaries in this study.](conceptFigs/FIMsystems.png){#fig-FIMsystems}

Within each estuary, sampling was divided into zones (subdivided into 1-nm^2^ grids) based on geographic, habitat, and depth criteria [@FWRIFloridaFishandWildlifeResearchInstitute2017]. These criteria defined which of three different types of gear were used to collect organisms. For this study, only the 21.3-m seine net were considered, because it was used the longest and most consistently throughout the study period. Specifically, this gear targeted young-of-year and juvenile fishes in shallow habitats (≤1.8-m deep). For every net deployment, all vertebrates and select commercially important invertebrates were counted and identified to the lowest practical taxonomic level (typically species). This study used all available seine data from 1998 to 2020. Further, each seine haul was categorized by season, with summer defined as June-September and winter as December-March, following [@Schrandt2020]. Due to the similarity in appearance, and thus difficulty for *in situ* species-level identification, certain taxa were aggregated at the genus level to reduce potential effects of misidentification @tbl-diffID. Finally, using a YSI sonde, several parameters, including water temperature, were recorded at the surface of the water and at the bottom during each sampling event.

```{r}
#| label: tbl-diffID
#| echo: FALSE
#| message: FALSE
#| tbl-cap: "Difficult to ID taxa"
knitr::kable(read.csv(file = "conceptFigs/diffIDTaxa.csv"))
```

### Data Analyses

```{r}
#| label: Models
#| include: FALSE
#| warning: FALSE
#| cache: TRUE
source("RichnessModel.R")
```

To address my first question, I modeled richness and abundance per haul across all estuaries for both the summer and winter seasons using Generalized Linear Mixed Models (GLMMs). For each seine haul, I calculated the richness as the number of taxa present and total abundance as the sum of all individuals counted. In all calculations, total abundance was fourth-root transformed to reduce the effects of overly-abundant taxa, given total abundance ranged from a maximum of `r max(totAbModelDF$abundRaw)` to `r min(totAbModelDF$abundRaw)`. For each model, the response in the GLMM included either the richness or transformed abundance of each haul, with estuary (four levels) as a fixed effect and year as a random effect. To account for serial autocorrelation, an ar1 covariance matrix was used in each model calculated from month of sampling event and within-estuary zone. Given that species richness is strongly affected by sampling effort [@Mittelbach2019], I included an offset term to account for variation in the number of seine hauls.

To examine other things some numbers were crunched. Used GLMMs. NMDS. PERMANOVA. RDA. CAP. Lots of linear models.

# Results {.unnumbered}

### Overview

```{r}
#| label: Temp_BVC
#| include: FALSE
#| message: FALSE
#| cache: TRUE
source("tempBVC.R")
winterStats <- filter(SXR_filtered, season == "winter")
summerStats <- filter(SXR_filtered, season == "summer")
winterAbStats <- filter(SXAb, season == "winter")
summerAbStats <- filter(SXAb, season == "summer")

```

In total, 17492 sampling events occurred where at least one taxa was caught and counted during summer or winter across all four estuaries. For seven sampling events, temperature data was unavailable and thus excluded from the analyses. Further, hauls that were comprised solely of rare species (taxa found in ≤5% of all samples for that system and season) were removed from the analyses which reduced samples down to `r nrow(SXS_filtered)`. Overall, `r ncol(SXS_filtered_spp)` taxa in the dataset were recorded, spanning `r max(as.numeric(as.character(waterBVC_full$seasonYear)))-min(as.numeric(as.character(waterBVC_full$seasonYear)))` years of collections.

Total richness was significantly changing (positively) only in winter in Tampa Bay (@fig-NPlot). However, the total richness in winter (average richness `r round(mean(winterStats$meanN),3)`) was consistently lower for each estuary than in the summer (average richness `r round(mean(summerStats$meanN),3)`).

```{r}
#| label: tbl-fullRichModels
#| echo: FALSE
#| message: FALSE
#| tbl-cap: "Richness GLMM"
emphasize.strong.cells(which(richFullPvalues < 0.05, arr.ind = TRUE))
pander(richFullEstimates)
```

```{r}
#| label: fig-NPlot
#| echo: FALSE
#| message: FALSE
#| fig.width: 7.5
#| fig.heigh: 5
#| fig-cap: "An amazing richness plot."
plot(NPlot)
```

Similarly, total abundance was generally lower for all systems in the winter season (average total abundance `r round(mean(winterAbStats$meanAb),3)`), with summer generally higher (average total abundance `r round(mean(summerAbStats$meanAb),3)`) (@fig-AbundPlot). Apalachicola Bay (in winter) and Tampa Bay (in summer) both have significant changes in total abundance over time, though AP is changing negatively and TB is changing positively.

```{r}
#| label: tbl-fullAbundModels
#| echo: FALSE
#| message: FALSE
#| tbl-cap: "Abundance GLMM"
emphasize.strong.cells(which(abundFullPvalues < 0.05, arr.ind = TRUE))
pander(abundFullEstimates)
```

```{r}
#| label: fig-AbundPlot
#| echo: FALSE
#| message: FALSE
#| fig.width: 7.5
#| fig.heigh: 5
#| fig-cap: "An amazing abundance plot."
plot(AbundPlot)
```

Seagrass coverage over time significantly changed in Cedar Key summer (negatively), Tampa Bay winter (positively), and in both seasons in Charlotte Harbor (positively) (@fig-BVCPlot).

```{r BVCPlot}
#| label: fig-BVCPlot
#| echo: FALSE
#| message: FALSE
#| fig.width: 7.5
#| fig.heigh: 5
#| fig-cap: "Yet another amazing plot"
plot(BVCPlot)
```

Temperature increased significantly through time for all estuaries in the winter and for AP and TB in the summer (@fig-TempPlot).

```{r}
#| label: fig-TempPlot
#| layout-ncol: 2
#| echo: FALSE
#| message: FALSE
#| warning: FALSE
#| fig.width: 7.5
#| fig.heigh: 5
#| fig-cap: "Charts"
#| fig-subcap: 
#|   - "One more amazing plot"
#|   - "Annually plotted"
plot(fullTemp)
plot(TempPlot)
```

Is there any association between changes in abundance and changes in temperature and/or seagrass coverage? GLMMs used to determine. Formula used for all models is: `abund ~ year_Z + temp_Z +  bvc_Z + offset(log(n_hauls)) + ar1(yearMonth + 0|systemZone)` where abund is ... z is ...

Here's what the abundance model output looks like for each system and season combination in @tbl-abundModels.

```{r}
#| label: tbl-abundModels
#| echo: FALSE
#| message: FALSE
#| tbl-cap: "The first table."
emphasize.strong.cells(which(abundPvalues < 0.05, arr.ind = TRUE))
pander(abundEstimates)
```

And this is for richness models as in @tbl-richModels.

```{r}
#| label: tbl-richModels
#| echo: FALSE
#| message: FALSE
#| tbl-cap: "The second table."
emphasize.strong.cells(which(richPvalues < 0.05, arr.ind = TRUE))
pander(richEstimates)
```

Looking closer at temp, specifically as in [@Miner2021], the upper and lower 10th percentiles of temp are sometimes changing. Mostly in winter, though not significant using linear model alone (@fig-upperLower).

```{r}
#| label: fig-upperLower
#| echo: FALSE
#| message: FALSE
#| fig.width: 7.5
#| fig.heigh: 5
#| fig-cap: "Still another amazing plot"
plot(annualTemp)
```

```{r}
#| label: BetaDiversity
#| include: FALSE
#| cache: TRUE
source("BetadiversityPairwise.R")
```

The betadiversity stuff is interesting (@fig-betadiversity).

```{r}
#| label: fig-betadiversity
#| echo: FALSE
#| message: FALSE
#| fig.width: 7.5
#| fig.heigh: 5
#| fig-cap: "Betadiversity amazing plot"
plot(betaTimePlot)
```
